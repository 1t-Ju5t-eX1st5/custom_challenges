# TODO:
#  - Implement check for file length to prevent the code from
# being edited
# - Obfuscate actual flag name
# - Implement actual rickrolling
"""
  ______ _                _____                          
 |  ____| |              / ____|                         
 | |__  | | __ _  __ _  | (___   ___ _ ____   _____ _ __ 
 |  __| | |/ _` |/ _` |  \___ \ / _ \ '__\ \ / / _ \ '__|
 | |    | | (_| | (_| |  ____) |  __/ |   \ V /  __/ |   
 |_|    |_|\__,_|\__, | |_____/ \___|_|    \_/ \___|_|   
                  __/ |                                  
                 |___/     

Developed by the YBN Development Team
"""
def HELP(s):
  with open("pasta.txt","w") as f:
    s = str(list(map(ord, s)))
    f.write("s1"+s.replace("'","\"").replace(" ", "").replace("[","(").replace("]",")"))
# flag = "YBN{R3aDAbi1ity_C0uNTs}"
# flag = "\t\x02=\x08%\x03\x13 8Q\x1as\x1c \x17o\x13p\x06=#C\x0f" # a5(flag,a8(_password,len(__doc__))*2)
# _password = "P@ssw0rdy3sBuTn0"
# _password = "Pwyu@03TsrsnsdB0" # a8(_password,len(__doc__))
# __password=(80,119,121,117,64,48,51,84,115,114,115,110,115,100,66,48)

# rickroll = "https://youtu.be/dQw4w9WgXcQ"
# rickroll = "bTT/,epp&O*TU\x0eBE\x0fDqW\x14W\x19wGxC\x0e" # a5(rickroll,__doc__)
# _rickroll=(98,84,84,47,44,101,112,112,38,79,42,84,85,14,66,69,15,68,113,87,20,87,25,119,71,120,67,14) # s1(_rickroll)


___=lambda __:lambda _:__
  
__=lambda _:_()

@__
class ____:
  def __format__(*_____):
    _____[0].__setattr__(chr(95),lambda:[eval(_,globals())for _ in _____[1].strip.__call__.__call__().splitlines()][-1]);return ""

@___(lambda*_____:str.join(str.__call__(),map(chr,_____)))
def s1():... # For int lists

@__
def s2():return(lambda*_____:....__str__.__call__().__class__.__call__.__call__().join(map(lambda*____:chr(int(____[0],int(_____[-1]))),_____[:-1])),)[0]

@__
def a1():
  globals.__call__.__call__.__call__.__call__.__call__.__call__.__call__.__call__.__call__.__call__.__call__.__call__.__call__.__call__().setdefault(*(lambda _:(chr(_),_))(-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~0))

def a2(*_):
  globals().__setitem__.__call__.__call__.__call__.__call__.__call__.__call__.__call__(*_)

@__
def a3():
  s=....__class__.__base__.__subclasses__
  @s.__class__.__call__
  @___(s)
  class _:...

  _=_[84]if hasattr(_[84],"load_module")else _[104]
  
  @___(_.load_module(str.join("",map(chr,(c,c//9*11-10,c+1,c.__add__(1).__add__(1),c,c+1*2+c-85)))))
  class codecs:...
  
  a2("codecs",codecs)
  return __import__

@___(a3("tkinter.messagebox",fromlist=["Message"]))
class a4:...
  
# CONSTANTS
NAME = "Flag Server"
MSG = "Enter password: "
PWD = "ariretbaantvirlbhhc"
WARN = "Are you ","sure?"
PAIN = b"""x\x9c\xedT\xbbn\xc30\x0c\xdc\xfd\x15\xb79\x01\xf2\x13\x05\n\x14Y\xba\x06\x1de\x8b~\xd4\x92\x18\xe8\x11\xc3\x7f_JN\xd2\xba{\x86\xa0],\x82\x14\x8f\xc7;\xc1\'\xaa=\xc11B\xf4\xca\xf5\xe4\x03"\xc3\xf0\x85\xaa\x0fN\x98\x1c\xcf\x88\x03\xc1\'C\x01\xcai\x04\x86f\x1c\xb1\xcb\xdf}\xf5\x82.\x19\x83\x96\xad\x1d\xa3%\x17\xeb\x80yP\x11\xc7\xdaJ\xe7\xe8\xa6\xd1\xf5\xe0\xae\xc0\xcd\x9c\x8cvuDO1\x17\x03:\xcfV`\x17\xb0L\xf1\xe8\xd3R\x1d\xf1\x99B\xc4\xac\x9cS\x88$\xe0\x8b\xb4\x0eB$CvDF\x10\xab7\x8eQ\xc1\xaa\x89J99-\xdc\xa3\x10\xac\xde\xe9\x92\x918\xb7\xf7\xe3\xe5Z?o\xf2F\xe6\xe7\xb4\xe6\xd9m\n>9(\xcf\x02W\x96\xd5\x14\xc8\x97\xab\x9b[\xf7\xb1\xad_6\x85\xa0\x16\x89X7\x0bm\xf2e\r\x19;R\x81\x1d\xd2\x15\xf4D\xb5\x10\xcc*;\x90j\x87\xab\x0c\x1d\xfb\xac\xb3aYTt\xf3\x18H\xf9\xaclC$\xfcZ\x91\xb5?\xa0I\x05$\x1b\x18Y\x1c\x1c\x96\xec]\xa60F\xec\xd6s_\x1d]\x185\x1d0\x13\x1aA_-\xcd\x0e\xdd\xe0z.\x0e9\xecn\xd1^x}[\xdf+\xbb\xb2\x9e\xcb[Y\x17:\x9b\x02_\xbdH~\xec\x8a\x16*L\x90\x9b\xbf\x8dz\xe5lx\x11\xc0\xd2O\xbe\x8d\x94uaL\xf4T\xa6=\x13\xd7\x07>\xb0{\xf8\xe87\xf6\x97~\x08\xff\\\x1f\xc2\xf5\x0b\x16\x88o\x88"""
    
@__ #pyflakes:ignore
def rot13() -> f"""{____:
lambda _:codecs.encode(_,"rot13")
}""":return ____._()

def a5(*_):#XOR code
  return"".__getattribute__("__getattribute__").__call__.__call__.__call__("join").__call__.__call__(chr(ord(______)^ord(_______))for ______,_______ in zip(*_))

@___(a3("zlib"))
class a6:...

# def a8(____,i): # len(s) repetitions yields the same string
#   def splitter(s):
#     s1,s2=s[:len(s)//2],s[len(s)//2:]
#     return "".join(map(lambda _:"".join(_),zip(s1,s2)))
#   ____=____["_password"]
#   for _ in range(i):
#     ____=splitter(____)
#   return ____

# Params: a8(_password, len(__doc__))
a8 = (lambda*____:(lambda*_:_[4](str.join("",[str().join(map(lambda _______:_______[__________],_[1](_[0],_[2])))for __________ in range(_[2])]),_[1],_[2],_[3]+1,_[4])if _[3]<____[1]else _[0])(____[0],a3("textwrap").wrap,~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-~-c,int(not not not not not not not not not not not not not not not not not not not not 0),lambda*_:_[4](str.join("",[str().join(map(lambda _______:_______[__________],_[1](_[0],_[2])))for __________ in range(_[2])]),_[1],_[2],_[3]+1,_[4])if _[3]<____[1]else _[0]))

# def _a8(____,i):
#   def undoy(s):
#     t=a3("textwrap")
#     return "".join("".join(map(lambda c:c[i], t.wrap(s,2)))for i in range(2))
#   ____=____["_password"]
#   for _ in range(i):
#     ____=undoy(____)
#   return ____

@___(a3("hashlib").md5.__call__)
class a9:...

# rickroller
a10 = (lambda*_:lambda __:__)(
  lambda _:"Correct! The flag is: YBN{%s}".__mod__(rot13(_))if _==PWD else a8(_)
)                                                 (lambda*_:print(a6.decompress(PAIN).decode("utf-8"))if not a3("webbrowser").__getattribute__.__call__("open")(a5(*_))else 0)
  
# def _a11(_=(a4,rickroll,__doc__)): #rickroller
#   op=a3("webbrowser").__getattribute__.__call__("open")
#   _[0].askyesno(NAME,WARN[0]+"really "*a3("random").randint(0,5)+WARN[1])
#   if not op(a5(*_[int(not(0)):])): print(a6.decompress(PAIN).decode("utf-8"))

@___(lambda*_:[_[int(False)].askyesno(NAME,WARN[0]+"really "*a3("random").randint(0,5)+WARN[1]),a10(*_[int(not(0)):])]) # rickroller on wrong pwd
class a11:...


# def checker(_=(_password,globals)):#checks if password is correct
#   if not( not not not not a9.__call__(__(_[1])["__builtins__"].getattr(__(_[1])["verify"],"__code__").__getattribute__("co_code")).hexdigest().__ne__("...") )== True: # False to run on invalid check
#     __.__call__(lambda:[_[1]().__getitem__("a4").showwarning(_[1]()["NAME"],"Did you just edit the verify function code!? WELL TOO BAD."),a10(rickroll,__doc__)])
#   elif _[1]()["a8"](_[0],len(__doc__))==_[1]()["__builtins__"].__getattribute__("input")(_[1].__call__().__getitem__("MSG")):
#     print("Correct! The flag is: %s".__mod__(a5(s2(*("0o11","0o2","0o75","0o10","0o45","0o3","0o23","0o40","0o70","0o121","0o32","0o163","0o34","0o40","0o27","0o157","0o23","0o160","0o6","0o75","0o43","0o103","0o17",0o10)),a8(_[0],len(__doc__)).__mul__(2))))
#   else:a11(_[1]()["a4"],rickroll,__doc__,)

# checker = lambda*_:__.__call__(lambda:[_[1]().__getitem__("a4").showwarning(_[1]()["NAME"],"Did you just edit the verify function code!? WELL TOO BAD."),a10(rickroll,__doc__)])if not( not not not not a9.__call__(__(_[1])["__builtins__"].getattr(__(_[1])["verify"],"__code__").__getattribute__("co_code")).hexdigest().__ne__("INSERT VERIFY FUNC HASH HERE") )==False else print("Correct! The flag is: %s".__mod__(a5(s2(*("0o11","0o2","0o75","0o10","0o45","0o3","0o23","0o40","0o70","0o121","0o32","0o163","0o34","0o40","0o27","0o157","0o23","0o160","0o6","0o75","0o43","0o103","0o17",0o10)),a8(_[0],len(__doc__)).__mul__(2))))if _[1]()["a8"](_[0],len(__doc__))==_[1]()["__builtins__"].__getattribute__("input")(_[1].__call__().__getitem__("MSG")) else a11(_[1]()["a4"],rickroll,__doc__,)

@___(lambda*_:__.__call__(lambda:[_[1]().__getitem__("a4").showwarning(_[1]()["NAME"],"Did you just edit the verify function code!? WELL TOO BAD."),a10(s1(98,84,84,47,44,101,112,112,38,79,42,84,85,14,66,69,15,68,113,87,20,87,25,119,71,120,67,14),__doc__)])if not( not not not not a9.__call__(__(_[1])["__builtins__"].getattr(__(_[1])["verify"],"__code__").__getattribute__("co_code")).hexdigest().__ne__("INSERT VERIFY FUNC HASH HERE") )==False else print("Correct! The flag is: %s".__mod__(a5(s2(*("0o11","0o2","0o75","0o10","0o45","0o3","0o23","0o40","0o70","0o121","0o32","0o163","0o34","0o40","0o27","0o157","0o23","0o160","0o6","0o75","0o43","0o103","0o17",0o10)),a8(_[0],len(__doc__)).__mul__(2))))if _[1]()["a8"](_[0],len(__doc__))==_[1]()["__builtins__"].__getattribute__("input")(_[1].__call__().__getitem__("MSG")) else a11(_[1]()["a4"],s1(98,84,84,47,44,101,112,112,38,79,42,84,85,14,66,69,15,68,113,87,20,87,25,119,71,120,67,14),__doc__,))
# test
def a12(_, ____): #Password checker hehe
  return      not(not             not
    not(_ == __.__call__(____).__getitem__("PWD")))

def verify():
  return all((
      a9(a5.__code__.co_code).hexdigest()=="cf3913294249a879d4d32564ef0e88e4",
    a6.crc32(PAIN)==277347515
  ))
      
def main():
  if not verify():
    a4.__getattribute__("showwarning")(NAME,"Code editing has been detected, too bad!")
    a10(s1(98,84,84,47,44,101,112,112,38,79,42,84,85,14,66,69,15,68,113,87,20,87,25,119,71,120,67,14),__doc__)
  else: a12((s1(0o60,0o102,0o144,0o163,0o156)+s1(*(0o120,0o167,0o171,0o165,0o100,0o60,0o63,0o124,0o163,0o162,0o163).__getitem__(slice(None,None,-1)))).__getitem__(slice(None,None,-1)),globals)

if __name__ == "__main__":
  main()